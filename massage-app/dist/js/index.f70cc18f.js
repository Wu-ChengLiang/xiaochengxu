var e=(e,s,a)=>new Promise((l,t)=>{var c=e=>{try{i(a.next(e))}catch(s){t(s)}},n=e=>{try{i(a.throw(e))}catch(s){t(s)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(c,n);i((a=a.apply(e,s)).next())});import{n as s,j as a,V as l,T as t,E as c,C as n,k as i,t as r}from"./vendors.fcaa4701.js";import{w as o,k as d}from"./common.326c60a3.js";const m=()=>{const[m,x]=s.useState(""),[h,u]=s.useState(!1),j=e=>{var s,a;const l=(null==(s=e.detail)?void 0:s.value)||(null==(a=e.target)?void 0:a.value)||"";/^\d*$/.test(l)&&x(l)},N=()=>e(void 0,null,function*(){var e,s;const a=Number(m),l=0;if(!a||a<=0)i({title:"\u8bf7\u8f93\u5165\u6709\u6548\u7684\u5145\u503c\u91d1\u989d",icon:"none"});else if(a>5e4)i({title:"\u5355\u6b21\u5145\u503c\u91d1\u989d\u4e0d\u80fd\u8d85\u8fc75\u4e07\u5143",icon:"none"});else{u(!0);try{const e=yield o.createRechargeOrder(a,l);if(console.log("\ud83d\udcb0 \u5145\u503c\u8ba2\u5355\u521b\u5efa\u6210\u529f:",e),console.log("\ud83d\udcb0 \u8ba2\u5355\u53f7:",e.orderNo),console.log("\ud83d\udcb0 \u652f\u4ed8\u53c2\u6570:",e.wxPayParams),!e.wxPayParams)throw new Error("\u83b7\u53d6\u652f\u4ed8\u53c2\u6570\u5931\u8d25");{const s=yield d.pay({orderNo:e.orderNo,amount:e.amount||100*a,paymentMethod:"wechat",title:`\u5145\u503c${a}\u5143${l>0?`(\u8d60${l}\u5143)`:""}`,wxPayParams:e.wxPayParams});s&&(i({title:"\u5145\u503c\u6210\u529f",icon:"success",duration:2e3}),setTimeout(()=>{r.navigateBack()},2e3))}}catch(t){(null==(e=t.message)?void 0:e.includes("\u7528\u6237\u53d6\u6d88"))||(null==(s=t.errMsg)?void 0:s.includes("cancel"))?i({title:"\u652f\u4ed8\u5df2\u53d6\u6d88",icon:"none"}):i({title:t.message||"\u5145\u503c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",icon:"none"})}finally{u(!1)}}});return a.jsxs(l,{className:"recharge-page",children:[a.jsx(l,{className:"amount-section",children:a.jsxs(l,{className:"custom-amount",children:[a.jsx(t,{className:"label",children:"\u8bf7\u8f93\u5165\u5145\u503c\u91d1\u989d"}),a.jsxs(l,{className:"input-wrapper",children:[a.jsx(t,{className:"prefix",children:"\xa5"}),a.jsx("input",{className:"input",type:"number",placeholder:"\u8bf7\u8f93\u5165\u5145\u503c\u91d1\u989d\uff08\u5355\u4f4d\uff1a\u5143\uff09",value:m,onInput:j})]})]})}),a.jsxs(l,{className:"tips-section",children:[a.jsx(t,{className:"section-title",children:"\u5145\u503c\u8bf4\u660e"}),a.jsxs(l,{className:"tips-list",children:[a.jsxs(l,{className:"tip-item",children:[a.jsx(t,{className:"dot",children:"\u2022"}),a.jsx(t,{className:"text",children:"\u5145\u503c\u91d1\u989d\u5c06\u5b9e\u65f6\u5230\u8d26\uff0c\u53ef\u7528\u4e8e\u652f\u4ed8\u63a8\u62ff\u670d\u52a1"})]}),a.jsxs(l,{className:"tip-item",children:[a.jsx(t,{className:"dot",children:"\u2022"}),a.jsx(t,{className:"text",children:"\u4f59\u989d\u4e0d\u652f\u6301\u63d0\u73b0\uff0c\u8bf7\u5408\u7406\u5145\u503c"})]}),a.jsxs(l,{className:"tip-item",children:[a.jsx(t,{className:"dot",children:"\u2022"}),a.jsx(t,{className:"text",children:"\u5145\u503c\u8d60\u9001\u91d1\u989d\u4e0e\u672c\u91d1\u540c\u7b49\u4f7f\u7528"})]})]})]}),a.jsx(l,{className:"bottom-bar",children:a.jsxs(c,{className:"recharge-btn",onClick:N,disabled:h,children:[a.jsx(n,{value:"credit-card",size:"20"}),a.jsx(t,{children:"\u7acb\u5373\u5145\u503c"})]})})]})};export{m as default};

{"version":3,"file":"index.js","sources":["../../../../src/pages/gift/product-detail/index.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { View, Text, Image, Button, Swiper, SwiperItem } from '@tarojs/components'\nimport Taro, { useRouter } from '@tarojs/taro'\nimport { AtIcon } from 'taro-ui'\nimport { GiftService } from '@/services/gift.service'\nimport { Product } from '@/types'\nimport './index.scss'\n\nconst ProductDetail: React.FC = () => {\n  const router = useRouter()\n  const { id } = router.params\n  const [productInfo, setProductInfo] = useState<Product | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [quantity, setQuantity] = useState(1)\n\n  useEffect(() => {\n    if (id) {\n      const product = GiftService.getProductById(id as string)\n      if (product) {\n        setProductInfo(product)\n      }\n      setLoading(false)\n    }\n  }, [id])\n\n  const handleQuantityChange = (type: 'increase' | 'decrease') => {\n    if (type === 'increase') {\n      setQuantity(quantity + 1)\n    } else if (type === 'decrease' && quantity > 1) {\n      setQuantity(quantity - 1)\n    }\n  }\n\n  const handleAddToCart = () => {\n    Taro.showToast({\n      title: '功能开发中',\n      icon: 'none'\n    })\n  }\n\n  const handleBuyNow = async () => {\n    if (!productInfo) return\n\n    try {\n      Taro.showLoading({ title: '创建订单...' })\n\n      const order = await GiftService.createProductOrder({\n        productId: productInfo.id,\n        quantity,\n        paymentMethod: 'wechat'\n      })\n\n      Taro.hideLoading()\n\n      if (order.paymentMethod === 'wechat' && order.wxPayParams) {\n        await GiftService.handleWechatPay(order.wxPayParams)\n        Taro.showToast({\n          title: '支付成功',\n          icon: 'success'\n        })\n      }\n    } catch (error: any) {\n      Taro.hideLoading()\n      Taro.showToast({\n        title: error.message || '购买失败',\n        icon: 'none'\n      })\n    }\n  }\n\n  if (loading) {\n    return (\n      <View className=\"product-detail-page\">\n        <View className=\"loading\">加载中...</View>\n      </View>\n    )\n  }\n\n  if (!productInfo) {\n    return (\n      <View className=\"product-detail-page\">\n        <View className=\"empty\">商品不存在</View>\n      </View>\n    )\n  }\n\n  return (\n    <View className=\"product-detail-page\">\n      {/* 商品图片轮播 */}\n      <Swiper className=\"product-swiper\" circular autoplay>\n        <SwiperItem>\n          <Image \n            className=\"product-image\" \n            src={productInfo.image}\n            mode=\"aspectFill\"\n          />\n        </SwiperItem>\n      </Swiper>\n\n      {/* 商品信息 */}\n      <View className=\"product-info\">\n        <View className=\"price-section\">\n          <View className=\"price-row\">\n            <Text className=\"price\">¥{productInfo.price.toFixed(2)}</Text>\n            <Text className=\"original-price\">¥{productInfo.originalPrice.toFixed(2)}</Text>\n          </View>\n          <Text className=\"unit\">/{productInfo.unit}</Text>\n        </View>\n        <Text className=\"product-name\">{productInfo.name}</Text>\n        <Text className=\"product-desc\">{productInfo.description}</Text>\n      </View>\n\n      {/* 商品特色 */}\n      <View className=\"features-section\">\n        <Text className=\"section-title\">产品特色</Text>\n        <View className=\"features-list\">\n          {productInfo.features.map((feature: string, index: number) => (\n            <View key={index} className=\"feature-item\">\n              <View className=\"feature-dot\" />\n              <Text className=\"feature-text\">{feature}</Text>\n            </View>\n          ))}\n        </View>\n      </View>\n\n      {/* 规格参数 */}\n      <View className=\"specs-section\">\n        <Text className=\"section-title\">规格参数</Text>\n        <View className=\"specs-list\">\n          {Object.entries(productInfo.specifications).map(([key, value]) => (\n            <View key={key} className=\"spec-item\">\n              <Text className=\"spec-label\">{key}</Text>\n              <Text className=\"spec-value\">{value as string}</Text>\n            </View>\n          ))}\n        </View>\n      </View>\n\n      {/* 数量选择 */}\n      <View className=\"quantity-section\">\n        <Text className=\"section-title\">购买数量</Text>\n        <View className=\"quantity-selector\">\n          <View \n            className=\"quantity-btn\"\n            onClick={() => handleQuantityChange('decrease')}\n          >\n            <AtIcon value=\"subtract\" size=\"20\" color={quantity === 1 ? '#ccc' : '#333'} />\n          </View>\n          <Text className=\"quantity-value\">{quantity}</Text>\n          <View \n            className=\"quantity-btn\"\n            onClick={() => handleQuantityChange('increase')}\n          >\n            <AtIcon value=\"add\" size=\"20\" color=\"#333\" />\n          </View>\n        </View>\n      </View>\n\n      {/* 底部操作栏 */}\n      <View className=\"action-bar\">\n        <Button className=\"action-btn cart-btn\" onClick={handleAddToCart}>\n          <AtIcon value=\"shopping-cart\" size=\"20\" />\n          <Text>加入购物车</Text>\n        </Button>\n        <Button className=\"action-btn buy-btn\" onClick={handleBuyNow}>\n          立即购买\n        </Button>\n      </View>\n    </View>\n  )\n}\n\nexport default ProductDetail"],"names":["ProductDetail","router","useRouter","id","params","productInfo","setProductInfo","useState","loading","setLoading","quantity","setQuantity","useEffect","product","GiftService","getProductById","handleQuantityChange","type","handleAddToCart","Taro","showToast","title","icon","handleBuyNow","showLoading","order","createProductOrder","productId","paymentMethod","hideLoading","wxPayParams","handleWechatPay","error","message","jsx","View","jsxs","Swiper","SwiperItem","Image","image","Text","price","toFixed","originalPrice","unit","name","description","features","map","feature","index","Object","entries","specifications","key","value","AtIcon","Button"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAQA,MAAMA,gBAA0BA,MAAM;AACpC,QAAMC,SAASC,KAAAA,YAAAA;AACT,QAAA,EAAEC,GAAG,IAAIF,OAAOG;AACtB,QAAM,CAACC,aAAaC,cAAc,IAAIC,cAAyB,IAAI;AACnE,QAAM,CAACC,SAASC,UAAU,IAAIF,cAAS,IAAI;AAC3C,QAAM,CAACG,UAAUC,WAAW,IAAIJ,cAAS,CAAC;AAE1CK,OAAAA,UAAU,MAAM;AACd,QAAIT,IAAI;AACAU,YAAAA,UAAUC,OAAAA,YAAYC,eAAeZ,EAAY;AACvD,UAAIU,SAAS;AACXP,uBAAeO,OAAO;AAAA,MACxB;AACAJ,iBAAW,KAAK;AAAA,IAClB;AAAA,EAAA,GACC,CAACN,EAAE,CAAC;AAEDa,QAAAA,uBAAuBA,CAACC,SAAkC;AAC9D,QAAIA,SAAS,YAAY;AACvBN,kBAAYD,WAAW,CAAC;AAAA,IACfO,WAAAA,SAAS,cAAcP,WAAW,GAAG;AAC9CC,kBAAYD,WAAW,CAAC;AAAA,IAC1B;AAAA,EAAA;AAGF,QAAMQ,kBAAkBA,MAAM;AAC5BC,SAAAA,KAAKC,UAAU;AAAA,MACbC,OAAO;AAAA,MACPC,MAAM;AAAA,IAAA,CACP;AAAA,EAAA;AAGH,QAAMC,eAAe,MAAY;AAC/B,QAAI,CAAClB;AAAa;AAEd,QAAA;AACFc,WAAAA,KAAKK,YAAY,EAAEH,OAAO,UAAW,CAAA;AAE/BI,YAAAA,QAAQ,MAAMX,OAAAA,YAAYY,mBAAmB;AAAA,QACjDC,WAAWtB,YAAYF;AAAAA,QACvBO;AAAAA,QACAkB,eAAe;AAAA,MAAA,CAChB;AAEDT,WAAAA,KAAKU,YAAY;AAEjB,UAAIJ,MAAMG,kBAAkB,YAAYH,MAAMK,aAAa;AACnDhB,cAAAA,mBAAYiB,gBAAgBN,MAAMK,WAAW;AACnDX,aAAAA,KAAKC,UAAU;AAAA,UACbC,OAAO;AAAA,UACPC,MAAM;AAAA,QAAA,CACP;AAAA,MACH;AAAA,aACOU,OAAY;AACnBb,WAAAA,KAAKU,YAAY;AACjBV,WAAAA,KAAKC,UAAU;AAAA,QACbC,OAAOW,MAAMC,WAAW;AAAA,QACxBX,MAAM;AAAA,MAAA,CACP;AAAA,IACH;AAAA,EAAA;AAGF,MAAId,SAAS;AAET,WAAA0B,qBAAAA,IAACC,KAAAA,QAAK,WAAU,uBACd,mCAACA,KAAK,MAAA,EAAA,WAAU,WAAU,UAAA,SAAM,CAAA,EAClC,CAAA;AAAA,EAEJ;AAEA,MAAI,CAAC9B,aAAa;AAEd,WAAA6B,qBAAAA,IAACC,KAAAA,QAAK,WAAU,uBACd,mCAACA,KAAK,MAAA,EAAA,WAAU,SAAQ,UAAA,QAAK,CAAA,EAC/B,CAAA;AAAA,EAEJ;AAGE,SAAAC,qBAAA,KAACD,KAAK,MAAA,EAAA,WAAU,uBAEd,UAAA;AAAA,IAACD,qBAAAA,IAAAG,KAAAA,QAAA,EAAO,WAAU,kBAAiB,UAAQ,MAAC,UAAQ,MAClD,mCAACC,KAAAA,YACC,EAAA,UAAAJ,qBAAA;AAAA,MAACK,KAAA;AAAA,MAAA;AAAA,QACC,WAAU;AAAA,QACV,KAAKlC,YAAYmC;AAAAA,QACjB,MAAK;AAAA,MAAA;AAAA,OAET,EACF,CAAA;AAAA,IAGAJ,qBAAAA,KAACD,KAAAA,MAAK,EAAA,WAAU,gBACd,UAAA;AAAA,MAACC,qBAAAA,KAAAD,KAAAA,MAAA,EAAK,WAAU,iBACd,UAAA;AAAA,QAACC,qBAAAA,KAAAD,KAAAA,MAAA,EAAK,WAAU,aACd,UAAA;AAAA,UAACC,qBAAAA,KAAAK,KAAAA,MAAA,EAAK,WAAU,SAAQ,UAAA;AAAA,YAAA;AAAA,YAAEpC,YAAYqC,MAAMC,QAAQ,CAAC;AAAA,UAAA,GAAE;AAAA,UACvDP,qBAAAA,KAACK,KAAAA,MAAK,EAAA,WAAU,kBAAiB,UAAA;AAAA,YAAA;AAAA,YAAEpC,YAAYuC,cAAcD,QAAQ,CAAC;AAAA,UAAA,GAAE;AAAA,QAAA,GAC1E;AAAA,QACAP,qBAAAA,KAACK,KAAAA,MAAK,EAAA,WAAU,QAAO,UAAA;AAAA,UAAA;AAAA,UAAEpC,YAAYwC;AAAAA,QAAAA,GAAK;AAAA,MAAA,GAC5C;AAAA,MACCX,qBAAA,IAAAO,KAAA,MAAA,EAAK,WAAU,gBAAgBpC,sBAAYyC,MAAK;AAAA,MAChDZ,qBAAA,IAAAO,KAAA,MAAA,EAAK,WAAU,gBAAgBpC,sBAAY0C,aAAY;AAAA,IAAA,GAC1D;AAAA,IAGAX,qBAAAA,KAACD,KAAAA,MAAK,EAAA,WAAU,oBACd,UAAA;AAAA,MAACD,qBAAA,IAAAO,KAAA,MAAA,EAAK,WAAU,iBAAgB,UAAI,QAAA;AAAA,MACnCP,qBAAA,IAAAC,KAAA,MAAA,EAAK,WAAU,iBACb9B,sBAAY2C,SAASC;AAAAA,QAAI,CAACC,SAAiBC,WACzCf,qBAAA,KAAAD,KAAA,MAAA,EAAiB,WAAU,gBAC1B,UAAA;AAAA,UAACD,qBAAAA,IAAAC,KAAA,MAAA,EAAK,WAAU,cAAa,CAAA;AAAA,UAC5BD,qBAAA,IAAAO,KAAA,MAAA,EAAK,WAAU,gBAAgBS,UAAQ,SAAA;AAAA,QAAA,EAAA,GAF/BC,MAGX;AAAA,MAAA,GAEJ;AAAA,IAAA,GACF;AAAA,IAGAf,qBAAAA,KAACD,KAAAA,MAAK,EAAA,WAAU,iBACd,UAAA;AAAA,MAACD,qBAAA,IAAAO,KAAA,MAAA,EAAK,WAAU,iBAAgB,UAAI,QAAA;AAAA,MACpCP,qBAAAA,IAACC,aAAK,WAAU,cACbiB,iBAAOC,QAAQhD,YAAYiD,cAAc,EAAEL;AAAAA,QAAI,CAAC,CAACM,KAAKC,KAAK,MACzDpB,qBAAAA,KAAAD,KAAAA,MAAA,EAAe,WAAU,aACxB,UAAA;AAAA,UAACD,qBAAA,IAAAO,KAAA,MAAA,EAAK,WAAU,cAAcc,UAAI,KAAA;AAAA,UACjCrB,qBAAA,IAAAO,KAAA,MAAA,EAAK,WAAU,cAAce,UAAgB,OAAA;AAAA,QAAA,EAAA,GAFrCD,GAGX;AAAA,MAAA,GAEJ;AAAA,IAAA,GACF;AAAA,IAGAnB,qBAAAA,KAACD,KAAAA,MAAK,EAAA,WAAU,oBACd,UAAA;AAAA,MAACD,qBAAA,IAAAO,KAAA,MAAA,EAAK,WAAU,iBAAgB,UAAI,QAAA;AAAA,MACpCL,qBAAAA,KAACD,KAAAA,MAAK,EAAA,WAAU,qBACd,UAAA;AAAA,QAAAD,qBAAA;AAAA,UAACC,KAAA;AAAA,UAAA;AAAA,YACC,WAAU;AAAA,YACV,SAAS,MAAMnB,qBAAqB,UAAU;AAAA,YAE9C,UAAAkB,qBAAAA,IAACuB,QAAAA,QAAO,EAAA,OAAM,YAAW,MAAK,MAAK,OAAO/C,aAAa,IAAI,SAAS,OAAO,CAAA;AAAA,UAAA;AAAA,QAC7E;AAAA,QACCwB,qBAAA,IAAAO,KAAA,MAAA,EAAK,WAAU,kBAAkB/B,UAAS,UAAA;AAAA,QAC3CwB,qBAAA;AAAA,UAACC,KAAA;AAAA,UAAA;AAAA,YACC,WAAU;AAAA,YACV,SAAS,MAAMnB,qBAAqB,UAAU;AAAA,YAE9C,mCAACyC,QAAO,QAAA,EAAA,OAAM,OAAM,MAAK,MAAK,OAAM,QAAM;AAAA,UAAA;AAAA,QAC5C;AAAA,MAAA,GACF;AAAA,IAAA,GACF;AAAA,IAGArB,qBAAAA,KAACD,KAAAA,MAAK,EAAA,WAAU,cACd,UAAA;AAAA,MAAAC,qBAAA,KAACsB,KAAO,QAAA,EAAA,WAAU,uBAAsB,SAASxC,iBAC/C,UAAA;AAAA,QAAAgB,qBAAA,IAACuB,QAAO,QAAA,EAAA,OAAM,iBAAgB,MAAK,MAAI;AAAA,QACvCvB,qBAAAA,IAACO,aAAK,UAAK,QAAA,CAAA;AAAA,MAAA,GACb;AAAA,+BACCiB,KAAAA,QAAO,EAAA,WAAU,sBAAqB,SAASnC,cAAa,UAE7D,QAAA;AAAA,IAAA,GACF;AAAA,EACF,EAAA,CAAA;AAEJ;;;;;"}
{"version":3,"file":"index.js","sources":["../../../../src/pages/gift/order-confirm/index.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { View, Text, Image, Button } from '@tarojs/components'\nimport Taro, { useRouter } from '@tarojs/taro'\nimport { AtIcon } from 'taro-ui'\nimport { GiftService } from '@/services/gift.service'\nimport './index.scss'\n\nconst OrderConfirm: React.FC = () => {\n  const router = useRouter()\n  const { orderNo, amount, quantity } = router.params\n  const [paymentMethod, setPaymentMethod] = useState('wechat')\n\n  const totalAmount = Number(amount) * Number(quantity)\n\n  const handlePayment = async () => {\n    if (!orderNo) {\n      Taro.showToast({\n        title: '订单信息错误',\n        icon: 'none'\n      })\n      return\n    }\n\n    try {\n      Taro.showLoading({ title: '支付中...' })\n\n      const result = await GiftService.payOrder({\n        orderNo: orderNo as string,\n        paymentMethod: paymentMethod as 'wechat' | 'balance'\n      })\n\n      Taro.hideLoading()\n\n      if (result.paymentMethod === 'wechat' && result.wxPayParams) {\n        await GiftService.handleWechatPay(result.wxPayParams)\n      }\n\n      Taro.showToast({\n        title: '支付成功',\n        icon: 'success',\n        duration: 2000\n      })\n\n      setTimeout(() => {\n        // 支付成功后跳转到礼卡列表或我的页面\n        Taro.navigateBack({ delta: 2 })\n      }, 2000)\n    } catch (error: any) {\n      Taro.hideLoading()\n      Taro.showToast({\n        title: error.message || '支付失败',\n        icon: 'none'\n      })\n    }\n  }\n\n  return (\n    <View className=\"order-confirm\">\n      {/* 订单信息 */}\n      <View className=\"order-info\">\n        <Text className=\"section-title\">电子礼卡</Text>\n        \n        <View className=\"card-item\">\n          <View className=\"card-preview\">\n            <Image \n              className=\"card-thumb\"\n              src=\"/assets/images/gift/card/gift-card.png\"\n              mode=\"aspectFill\"\n            />\n            <View className=\"card-badge\">\n              <AtIcon value=\"tag\" size=\"12\" color=\"#fff\" />\n              <Text>世界上最好的爸爸</Text>\n            </View>\n          </View>\n          \n          <View className=\"card-details\">\n            <Text className=\"card-name\">电子礼卡</Text>\n            <View className=\"price-quantity\">\n              <Text className=\"price\">¥ {amount}</Text>\n              <Text className=\"quantity\">×{quantity}</Text>\n            </View>\n          </View>\n        </View>\n      </View>\n\n      {/* 支付方式 */}\n      <View className=\"payment-section\">\n        <Text className=\"section-title\">支付方式</Text>\n        \n        <View \n          className={`payment-method ${paymentMethod === 'wechat' ? 'selected' : ''}`}\n          onClick={() => setPaymentMethod('wechat')}\n        >\n          <View className=\"method-info\">\n            <AtIcon value=\"sketch\" size=\"20\" color=\"#1AAD19\" />\n            <Text className=\"method-name\">微信支付</Text>\n          </View>\n          <AtIcon \n            value={paymentMethod === 'wechat' ? 'check-circle' : 'circle'} \n            size=\"20\" \n            color={paymentMethod === 'wechat' ? '#a40035' : '#999'}\n          />\n        </View>\n      </View>\n\n      {/* 底部支付栏 */}\n      <View className=\"payment-bar\">\n        <View className=\"total-amount\">\n          <Text className=\"amount-symbol\">¥</Text>\n          <Text className=\"amount-value\">{totalAmount}</Text>\n        </View>\n        <Button className=\"pay-btn\" onClick={handlePayment}>\n          去支付\n        </Button>\n      </View>\n    </View>\n  )\n}\n\nexport default OrderConfirm"],"names":["OrderConfirm","router","useRouter","orderNo","amount","quantity","params","paymentMethod","setPaymentMethod","useState","totalAmount","Number","handlePayment","Taro","showToast","title","icon","showLoading","result","GiftService","payOrder","hideLoading","wxPayParams","handleWechatPay","duration","setTimeout","navigateBack","delta","error","message","jsxs","View","jsx","Text","Image","AtIcon","Button"],"mappings":"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"}
"use strict";var e=(e,s,t)=>new Promise((i,a)=>{var n=e=>{try{r(t.next(e))}catch(s){a(s)}},o=e=>{try{r(t.throw(e))}catch(s){a(s)}},r=e=>e.done?i(e.value):Promise.resolve(e.value).then(n,o);r((t=t.apply(e,s)).next())});const s=require("../../../taro.js"),t=require("../../../vendors.js"),i=require("../../../common.js"),a="",n=()=>{const[a,n]=s.reactExports.useState(0),[o,r]=s.reactExports.useState(""),[x,c]=s.reactExports.useState(!1),l=i.walletService.getRechargeOptions(),m=e=>{n(e),r("")},u=e=>{var s,t;const i=(null==(s=e.detail)?void 0:s.value)||(null==(t=e.target)?void 0:t.value)||"";/^\d*$/.test(i)&&(r(i),n(0))},j=()=>e(exports,null,function*(){const e=a||Number(o);if(!e||e<=0)s.Taro.showToast({title:"\u8bf7\u9009\u62e9\u6216\u8f93\u5165\u5145\u503c\u91d1\u989d",icon:"none"});else if(e>5e4)s.Taro.showToast({title:"\u5355\u6b21\u5145\u503c\u91d1\u989d\u4e0d\u80fd\u8d85\u8fc75\u4e07\u5143",icon:"none"});else{c(!0);try{s.Taro.showLoading({title:"\u6b63\u5728\u652f\u4ed8..."}),yield new Promise(e=>setTimeout(e,1500));const t=l.find(s=>s.amount===e),a=(null==t?void 0:t.bonus)||0,n=e+a,o=yield i.walletService.recharge(n,a>0?`\u5145\u503c${e}\u5143\uff0c\u8d60\u9001${a}\u5143`:`\u5145\u503c${e}\u5143`);s.Taro.hideLoading(),o.success?(s.Taro.showToast({title:"\u5145\u503c\u6210\u529f",icon:"success",duration:2e3}),setTimeout(()=>{s.Taro.navigateBack()},2e3)):s.Taro.showToast({title:o.message||"\u5145\u503c\u5931\u8d25",icon:"none"})}catch(t){s.Taro.hideLoading(),s.Taro.showToast({title:"\u5145\u503c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",icon:"none"})}finally{c(!1)}}});return s.jsxRuntimeExports.jsxs(s.View,{className:"recharge-page",children:[s.jsxRuntimeExports.jsxs(s.View,{className:"amount-section",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"section-title",children:"\u9009\u62e9\u5145\u503c\u91d1\u989d"}),s.jsxRuntimeExports.jsx(s.View,{className:"amount-grid",children:l.map(e=>s.jsxRuntimeExports.jsxs(s.View,{className:"amount-card "+(a===e.amount?"active":""),onClick:()=>m(e.amount),children:[s.jsxRuntimeExports.jsxs(s.Text,{className:"amount",children:["\xa5",e.amount]}),e.bonus>0&&s.jsxRuntimeExports.jsxs(s.Text,{className:"bonus",children:["\u8d60\u9001",e.bonus,"\u5143"]})]},e.amount))}),s.jsxRuntimeExports.jsxs(s.View,{className:"custom-amount",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"label",children:"\u5176\u4ed6\u91d1\u989d"}),s.jsxRuntimeExports.jsxs(s.View,{className:"input-wrapper",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"prefix",children:"\xa5"}),s.jsxRuntimeExports.jsx("input",{className:"input",type:"number",placeholder:"\u8bf7\u8f93\u5165\u5145\u503c\u91d1\u989d",value:o,onInput:u})]})]})]}),s.jsxRuntimeExports.jsxs(s.View,{className:"tips-section",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"section-title",children:"\u5145\u503c\u8bf4\u660e"}),s.jsxRuntimeExports.jsxs(s.View,{className:"tips-list",children:[s.jsxRuntimeExports.jsxs(s.View,{className:"tip-item",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"dot",children:"\u2022"}),s.jsxRuntimeExports.jsx(s.Text,{className:"text",children:"\u5145\u503c\u91d1\u989d\u5c06\u5b9e\u65f6\u5230\u8d26\uff0c\u53ef\u7528\u4e8e\u652f\u4ed8\u63a8\u62ff\u670d\u52a1"})]}),s.jsxRuntimeExports.jsxs(s.View,{className:"tip-item",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"dot",children:"\u2022"}),s.jsxRuntimeExports.jsx(s.Text,{className:"text",children:"\u4f59\u989d\u4e0d\u652f\u6301\u63d0\u73b0\uff0c\u8bf7\u5408\u7406\u5145\u503c"})]}),s.jsxRuntimeExports.jsxs(s.View,{className:"tip-item",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"dot",children:"\u2022"}),s.jsxRuntimeExports.jsx(s.Text,{className:"text",children:"\u5145\u503c\u8d60\u9001\u91d1\u989d\u4e0e\u672c\u91d1\u540c\u7b49\u4f7f\u7528"})]})]})]}),s.jsxRuntimeExports.jsx(s.View,{className:"bottom-bar",children:s.jsxRuntimeExports.jsxs(s.Button,{className:"recharge-btn",onClick:j,disabled:x,children:[s.jsxRuntimeExports.jsx(t.AtIcon,{value:"credit-card",size:"20"}),s.jsxRuntimeExports.jsx(s.Text,{children:"\u7acb\u5373\u5145\u503c"})]})})]})};var o={navigationBarTitleText:"\u4f59\u989d\u5145\u503c"};Page(s.createPageConfig(n,"pages/mine/recharge/index",{root:{cn:[]}},o||{}));

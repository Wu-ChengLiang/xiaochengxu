"use strict";var e=(e,s,t)=>new Promise((a,r)=>{var i=e=>{try{o(t.next(e))}catch(s){r(s)}},n=e=>{try{o(t.throw(e))}catch(s){r(s)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((t=t.apply(e,s)).next())});const s=require("../../../taro.js"),t=require("../../../vendors.js"),a=require("../../../common.js"),r="",i=()=>{const[r,i]=s.reactExports.useState(""),[n,o]=s.reactExports.useState(!1),x=e=>{var s,t;const a=(null==(s=e.detail)?void 0:s.value)||(null==(t=e.target)?void 0:t.value)||"";/^\d*$/.test(a)&&i(a)},c=()=>e(exports,null,function*(){var e,t;const i=Number(r),n=0;if(!i||i<=0)s.Taro.showToast({title:"\u8bf7\u8f93\u5165\u6709\u6548\u7684\u5145\u503c\u91d1\u989d",icon:"none"});else if(i>5e4)s.Taro.showToast({title:"\u5355\u6b21\u5145\u503c\u91d1\u989d\u4e0d\u80fd\u8d85\u8fc75\u4e07\u5143",icon:"none"});else{o(!0);try{const e=yield a.walletService.createRechargeOrder(i,n);if(console.log("\ud83d\udcb0 \u5145\u503c\u8ba2\u5355\u521b\u5efa\u6210\u529f:",e),console.log("\ud83d\udcb0 \u8ba2\u5355\u53f7:",e.orderNo),console.log("\ud83d\udcb0 \u652f\u4ed8\u53c2\u6570:",e.wxPayParams),!e.wxPayParams)throw new Error("\u83b7\u53d6\u652f\u4ed8\u53c2\u6570\u5931\u8d25");{const t=yield a.paymentService.pay({orderNo:e.orderNo,amount:e.amount||100*i,paymentMethod:"wechat",title:`\u5145\u503c${i}\u5143${n>0?`(\u8d60${n}\u5143)`:""}`,wxPayParams:e.wxPayParams});t&&(s.Taro.showToast({title:"\u5145\u503c\u6210\u529f",icon:"success",duration:2e3}),setTimeout(()=>{s.Taro.navigateBack()},2e3))}}catch(x){(null==(e=x.message)?void 0:e.includes("\u7528\u6237\u53d6\u6d88"))||(null==(t=x.errMsg)?void 0:t.includes("cancel"))?s.Taro.showToast({title:"\u652f\u4ed8\u5df2\u53d6\u6d88",icon:"none"}):s.Taro.showToast({title:x.message||"\u5145\u503c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",icon:"none"})}finally{o(!1)}}});return s.jsxRuntimeExports.jsxs(s.View,{className:"recharge-page",children:[s.jsxRuntimeExports.jsx(s.View,{className:"amount-section",children:s.jsxRuntimeExports.jsxs(s.View,{className:"custom-amount",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"label",children:"\u8bf7\u8f93\u5165\u5145\u503c\u91d1\u989d"}),s.jsxRuntimeExports.jsxs(s.View,{className:"input-wrapper",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"prefix",children:"\xa5"}),s.jsxRuntimeExports.jsx("input",{className:"input",type:"number",placeholder:"\u8bf7\u8f93\u5165\u5145\u503c\u91d1\u989d\uff08\u5355\u4f4d\uff1a\u5143\uff09",value:r,onInput:x})]})]})}),s.jsxRuntimeExports.jsxs(s.View,{className:"tips-section",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"section-title",children:"\u5145\u503c\u8bf4\u660e"}),s.jsxRuntimeExports.jsxs(s.View,{className:"tips-list",children:[s.jsxRuntimeExports.jsxs(s.View,{className:"tip-item",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"dot",children:"\u2022"}),s.jsxRuntimeExports.jsx(s.Text,{className:"text",children:"\u5145\u503c\u91d1\u989d\u5c06\u5b9e\u65f6\u5230\u8d26\uff0c\u53ef\u7528\u4e8e\u652f\u4ed8\u63a8\u62ff\u670d\u52a1"})]}),s.jsxRuntimeExports.jsxs(s.View,{className:"tip-item",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"dot",children:"\u2022"}),s.jsxRuntimeExports.jsx(s.Text,{className:"text",children:"\u4f59\u989d\u4e0d\u652f\u6301\u63d0\u73b0\uff0c\u8bf7\u5408\u7406\u5145\u503c"})]}),s.jsxRuntimeExports.jsxs(s.View,{className:"tip-item",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"dot",children:"\u2022"}),s.jsxRuntimeExports.jsx(s.Text,{className:"text",children:"\u5145\u503c\u8d60\u9001\u91d1\u989d\u4e0e\u672c\u91d1\u540c\u7b49\u4f7f\u7528"})]})]})]}),s.jsxRuntimeExports.jsx(s.View,{className:"bottom-bar",children:s.jsxRuntimeExports.jsxs(s.Button,{className:"recharge-btn",onClick:c,disabled:n,children:[s.jsxRuntimeExports.jsx(t.AtIcon,{value:"credit-card",size:"20"}),s.jsxRuntimeExports.jsx(s.Text,{children:"\u7acb\u5373\u5145\u503c"})]})})]})};var n={navigationBarTitleText:"\u4f59\u989d\u5145\u503c"};Page(s.createPageConfig(i,"pages/mine/recharge/index",{root:{cn:[]}},n||{}));

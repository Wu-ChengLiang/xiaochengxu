{"version":3,"file":"index.js","sources":["../../../../src/pages/mine/recharge/index.tsx"],"sourcesContent":["import React, { useState } from 'react'\nimport { View, Text, Button } from '@tarojs/components'\nimport Taro from '@tarojs/taro'\nimport { AtIcon } from 'taro-ui'\nimport { walletService } from '@/services/wallet.service'\nimport './index.scss'\n\nconst Recharge: React.FC = () => {\n  const [selectedAmount, setSelectedAmount] = useState(0)\n  const [customAmount, setCustomAmount] = useState('')\n  const [loading, setLoading] = useState(false)\n\n  // 获取充值选项\n  const rechargeOptions = walletService.getRechargeOptions()\n\n  const handleAmountSelect = (amount: number) => {\n    setSelectedAmount(amount)\n    setCustomAmount('')\n  }\n\n  const handleCustomAmountChange = (e: any) => {\n    const value = e.detail?.value || e.target?.value || ''\n    if (/^\\d*$/.test(value)) {\n      setCustomAmount(value)\n      setSelectedAmount(0)\n    }\n  }\n\n  const handleRecharge = async () => {\n    const amount = selectedAmount || Number(customAmount)\n\n    if (!amount || amount <= 0) {\n      Taro.showToast({\n        title: '请选择或输入充值金额',\n        icon: 'none'\n      })\n      return\n    }\n\n    if (amount > 50000) {\n      Taro.showToast({\n        title: '单次充值金额不能超过5万元',\n        icon: 'none'\n      })\n      return\n    }\n\n    setLoading(true)\n\n    try {\n      // 模拟微信支付\n      Taro.showLoading({ title: '正在支付...' })\n\n      // Mock 支付延迟\n      await new Promise(resolve => setTimeout(resolve, 1500))\n\n      // 查找对应的充值选项，获取赠送金额\n      const option = rechargeOptions.find(opt => opt.amount === amount)\n      const bonus = option?.bonus || 0\n      const totalAmount = amount + bonus\n\n      // 充值到余额\n      const result = await walletService.recharge(\n        totalAmount,\n        bonus > 0 ? `充值${amount}元，赠送${bonus}元` : `充值${amount}元`\n      )\n\n      Taro.hideLoading()\n\n      if (result.success) {\n        Taro.showToast({\n          title: '充值成功',\n          icon: 'success',\n          duration: 2000\n        })\n\n        setTimeout(() => {\n          Taro.navigateBack()\n        }, 2000)\n      } else {\n        Taro.showToast({\n          title: result.message || '充值失败',\n          icon: 'none'\n        })\n      }\n    } catch (error) {\n      Taro.hideLoading()\n      Taro.showToast({\n        title: '充值失败，请重试',\n        icon: 'none'\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <View className=\"recharge-page\">\n      {/* 充值金额选择 */}\n      <View className=\"amount-section\">\n        <Text className=\"section-title\">选择充值金额</Text>\n        <View className=\"amount-grid\">\n          {rechargeOptions.map((option) => (\n            <View\n              key={option.amount}\n              className={`amount-card ${selectedAmount === option.amount ? 'active' : ''}`}\n              onClick={() => handleAmountSelect(option.amount)}\n            >\n              <Text className=\"amount\">¥{option.amount}</Text>\n              {option.bonus > 0 && (\n                <Text className=\"bonus\">赠送{option.bonus}元</Text>\n              )}\n            </View>\n          ))}\n        </View>\n\n        {/* 自定义金额 */}\n        <View className=\"custom-amount\">\n          <Text className=\"label\">其他金额</Text>\n          <View className=\"input-wrapper\">\n            <Text className=\"prefix\">¥</Text>\n            <input\n              className=\"input\"\n              type=\"number\"\n              placeholder=\"请输入充值金额\"\n              value={customAmount}\n              onInput={handleCustomAmountChange}\n            />\n          </View>\n        </View>\n      </View>\n\n      {/* 充值说明 */}\n      <View className=\"tips-section\">\n        <Text className=\"section-title\">充值说明</Text>\n        <View className=\"tips-list\">\n          <View className=\"tip-item\">\n            <Text className=\"dot\">•</Text>\n            <Text className=\"text\">充值金额将实时到账，可用于支付推拿服务</Text>\n          </View>\n          <View className=\"tip-item\">\n            <Text className=\"dot\">•</Text>\n            <Text className=\"text\">余额不支持提现，请合理充值</Text>\n          </View>\n          <View className=\"tip-item\">\n            <Text className=\"dot\">•</Text>\n            <Text className=\"text\">充值赠送金额与本金同等使用</Text>\n          </View>\n        </View>\n      </View>\n\n      {/* 底部充值按钮 */}\n      <View className=\"bottom-bar\">\n        <Button\n          className=\"recharge-btn\"\n          onClick={handleRecharge}\n          disabled={loading}\n        >\n          <AtIcon value=\"credit-card\" size=\"20\" />\n          <Text>立即充值</Text>\n        </Button>\n      </View>\n    </View>\n  )\n}\n\nexport default Recharge"],"names":["Recharge","selectedAmount","setSelectedAmount","useState","customAmount","setCustomAmount","loading","setLoading","rechargeOptions","walletService","getRechargeOptions","handleAmountSelect","amount","handleCustomAmountChange","e","value","detail","target","test","handleRecharge","Number","Taro","showToast","title","icon","showLoading","Promise","resolve","setTimeout","option","find","opt","bonus","totalAmount","result","recharge","hideLoading","success","duration","navigateBack","message","error","jsxs","View","jsx","Text","map","Button","AtIcon"],"mappings":"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"}
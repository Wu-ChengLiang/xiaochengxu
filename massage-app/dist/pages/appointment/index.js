"use strict";var e=(e,s,t)=>new Promise((i,a)=>{var r=e=>{try{o(t.next(e))}catch(s){a(s)}},n=e=>{try{o(t.throw(e))}catch(s){a(s)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,n);o((t=t.apply(e,s)).next())});const s=require("../../taro.js"),t=require("../../common.js"),i=require("../../vendors.js"),a=[{id:"therapist-001",storeId:"store-001",storeName:"\u4e0a\u6d77\u4e07\u8c61\u57ce\u5e97",name:"\u5218\u5409\u4f1a",avatar:t.mockImages.therapists.male[0],rating:5,ratingCount:328,expertise:["\u64c5\u957f","\u5934\u9888\u80a9\u75db","\u8db3\u7597+\u8e29\u80cc"],yearsOfExperience:8,serviceCount:1523,status:"available",distance:8.8},{id:"therapist-002",storeId:"store-001",storeName:"\u4e0a\u6d77\u4e07\u8c61\u57ce\u5e97",name:"\u8c22\u5c0f\u6e05",avatar:t.mockImages.therapists.female[0],rating:4.9,ratingCount:267,expertise:["\u64c5\u957f","\u7761\u7720\u8c03\u7406","\u8fd0\u52a8\u6392\u9178"],yearsOfExperience:6,serviceCount:982,status:"available",distance:8.8},{id:"therapist-003",storeId:"store-002",storeName:"\u957f\u5b81\u6765\u798f\u58eb",name:"\u5f20\u660e\u534e",avatar:t.mockImages.therapists.male[1],rating:4.8,ratingCount:195,expertise:["\u64c5\u957f","\u8170\u817f\u75bc\u75db","\u7ecf\u7edc\u758f\u901a"],yearsOfExperience:10,serviceCount:2156,status:"busy",distance:12.3},{id:"therapist-004",storeId:"store-002",storeName:"\u957f\u5b81\u6765\u798f\u58eb",name:"\u738b\u96c5\u7434",avatar:t.mockImages.therapists.female[1],rating:5,ratingCount:412,expertise:["\u64c5\u957f","\u80a9\u5468\u708e","\u4ea7\u540e\u6062\u590d"],yearsOfExperience:12,serviceCount:3421,status:"available",distance:14.2},{id:"therapist-005",storeId:"store-003",storeName:"\u9759\u5b89\u5927\u60a6\u57ce\u5e97",name:"\u674e\u5efa\u56fd",avatar:t.mockImages.therapists.male[2],rating:4.7,ratingCount:156,expertise:["\u64c5\u957f","\u5173\u8282\u8c03\u7406","\u810a\u67f1\u77eb\u6b63"],yearsOfExperience:15,serviceCount:4523,status:"available",distance:15.6},{id:"therapist-006",storeId:"store-004",storeName:"\u6d66\u4e1c\u6b63\u5927\u5e7f\u573a\u5e97",name:"\u9648\u79c0\u82f1",avatar:t.mockImages.therapists.female[0],rating:4.9,ratingCount:289,expertise:["\u64c5\u957f","\u6dcb\u5df4\u6392\u6bd2","\u9762\u90e8\u62a4\u7406"],yearsOfExperience:9,serviceCount:2134,status:"available",distance:18.9},{id:"therapist-007",storeId:"store-005",storeName:"\u5f90\u6c47\u65e5\u6708\u5149\u5e97",name:"\u8d75\u6587\u658c",avatar:t.mockImages.therapists.male[0],rating:4.8,ratingCount:178,expertise:["\u64c5\u957f","\u8fd0\u52a8\u635f\u4f24","\u7b4b\u819c\u653e\u677e"],yearsOfExperience:7,serviceCount:1678,status:"busy",distance:6.5},{id:"therapist-008",storeId:"store-005",storeName:"\u5f90\u6c47\u65e5\u6708\u5149\u5e97",name:"\u5b59\u96ea\u6885",avatar:t.mockImages.therapists.female[1],rating:5,ratingCount:523,expertise:["\u64c5\u957f","\u5168\u8eab\u63a8\u62ff","\u827e\u7078\u7406\u7597"],yearsOfExperience:11,serviceCount:3876,status:"available",distance:6.5}],r=e=>new Promise(s=>setTimeout(s,e));class n{getRecommendedTherapists(s=1,t=10){return e(this,null,function*(){yield r(300);const e=[...a].sort((e,s)=>s.rating!==e.rating?s.rating-e.rating:s.serviceCount-e.serviceCount),i=(s-1)*t,n=i+t,o=e.slice(i,n);return{list:o,total:e.length,page:s,pageSize:t,hasMore:n<e.length}})}getTherapistsByStore(s,t=1,i=10){return e(this,null,function*(){yield r(200);const e=a.filter(e=>e.storeId===s),n=(t-1)*i,o=n+i,c=e.slice(n,o);return{list:c,total:e.length,page:t,pageSize:i,hasMore:o<e.length}})}getTherapistDetail(s){return e(this,null,function*(){yield r(200);const e=a.find(e=>e.id===s);if(!e)throw new Error("\u63a8\u62ff\u5e08\u4e0d\u5b58\u5728");return e})}getTherapistsByExpertise(s,t=1,i=10){return e(this,null,function*(){yield r(300);const e=a.filter(e=>e.expertise.includes(s)),n=(t-1)*i,o=n+i,c=e.slice(n,o);return{list:c,total:e.length,page:t,pageSize:i,hasMore:o<e.length}})}searchTherapists(s,t=1,i=10){return e(this,null,function*(){yield r(300);const e=a.filter(e=>{var t;return e.name.includes(s)||e.expertise.some(e=>e.includes(s))||(null==(t=e.storeName)?void 0:t.includes(s))}),n=(t-1)*i,o=n+i,c=e.slice(n,o);return{list:c,total:e.length,page:t,pageSize:i,hasMore:o<e.length}})}}const o=new n,c="",l=({store:e,onClick:t,onBooking:a})=>{const r=e=>{switch(e){case"normal":return"\u5c31\u8fd1";case"busy":return"\u7e41\u5fd9";case"full":return"\u7206\u6ee1";default:return""}},n=e=>{switch(e){case"normal":return"status-normal";case"busy":return"status-busy";case"full":return"status-full";default:return""}};return s.jsxRuntimeExports.jsx(s.View,{className:"store-card",onClick:t,children:s.jsxRuntimeExports.jsxs(s.View,{className:"card-content",children:[s.jsxRuntimeExports.jsx(s.Image,{className:"store-image",src:e.images[0],mode:"aspectFill"}),s.jsxRuntimeExports.jsxs(s.View,{className:"store-info",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"store-name",children:e.name}),s.jsxRuntimeExports.jsxs(s.View,{className:"business-hours",children:[s.jsxRuntimeExports.jsxs(s.Text,{className:"hours-text",children:[e.businessHours.start,"-",e.businessHours.end]}),s.jsxRuntimeExports.jsx(s.Text,{className:`status ${n(e.status)}`,children:r(e.status)})]}),s.jsxRuntimeExports.jsx(s.View,{className:"store-address",children:s.jsxRuntimeExports.jsx(s.Text,{className:"address-text",numberOfLines:1,children:e.address})}),s.jsxRuntimeExports.jsxs(s.View,{className:"store-footer",children:[s.jsxRuntimeExports.jsxs(s.View,{className:"distance",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"icon",children:"\ud83d\udccd"}),s.jsxRuntimeExports.jsxs(s.Text,{className:"distance-text",children:[e.distance,"km"]})]}),s.jsxRuntimeExports.jsx(i.AtButton,{className:"booking-btn",type:"primary",size:"small",onClick:a,children:"\u9884\u7ea6"})]})]})]})})},x="",m=({therapist:e,onClick:t,onBooking:a})=>s.jsxRuntimeExports.jsx(s.View,{className:"therapist-card",onClick:t,children:s.jsxRuntimeExports.jsxs(s.View,{className:"card-content",children:[s.jsxRuntimeExports.jsx(s.Image,{className:"therapist-avatar",src:e.avatar,mode:"aspectFill"}),s.jsxRuntimeExports.jsxs(s.View,{className:"therapist-info",children:[s.jsxRuntimeExports.jsxs(s.View,{className:"info-header",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"therapist-name",children:e.name}),s.jsxRuntimeExports.jsxs(s.View,{className:"distance",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"icon",children:"\ud83d\udccd"}),s.jsxRuntimeExports.jsxs(s.Text,{className:"distance-text",children:[e.distance,"km"]})]})]}),s.jsxRuntimeExports.jsx(s.View,{className:"expertise-tags",children:e.expertise.map((e,t)=>s.jsxRuntimeExports.jsx(s.Text,{className:"expertise-tag",children:e},t))}),s.jsxRuntimeExports.jsxs(s.View,{className:"therapist-footer",children:[s.jsxRuntimeExports.jsxs(s.View,{className:"rating",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"icon",children:"\u2b50"}),s.jsxRuntimeExports.jsxs(s.Text,{className:"rating-text",children:[e.rating,"\u5206"]}),s.jsxRuntimeExports.jsxs(s.Text,{className:"service-count",children:["\u670d\u52a1",e.serviceCount,"\u6b21"]})]}),s.jsxRuntimeExports.jsx(i.AtButton,{className:"booking-btn",type:"primary",size:"small",onClick:a,children:"\u9884\u7ea6"})]})]})]})}),u="",p=()=>{const[i,a]=s.reactExports.useState(!0),[r,n]=s.reactExports.useState([]),[c,x]=s.reactExports.useState([]),[u,p]=s.reactExports.useState({latitude:0,longitude:0}),d=[{id:1,image:t.bannerGoodnight,title:"\u665a\u5b89\u597d\u7720",subtitle:"\u6df1\u5ea6\u653e\u677e\u52a9\u7720\u670d\u52a1",link:""}];s.reactExports.useEffect(()=>{h()},[]);const h=()=>e(exports,null,function*(){try{a(!0);const e=yield t.getLocationService.getCurrentLocation();p(e);const s=yield t.storeService.getNearbyStores(e.latitude,e.longitude,1,2);n(s.list);const i=yield o.getRecommendedTherapists();x(i.list)}catch(e){console.error("\u52a0\u8f7d\u6570\u636e\u5931\u8d25:",e),s.Taro.showToast({title:"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",icon:"none"})}finally{a(!1)}}),j=e=>{s.Taro.navigateTo({url:`/pages/appointment/store/index?id=${e.id}`})},g=e=>{s.Taro.navigateTo({url:`/pages/therapist/detail/index?id=${e.id}`})},E=(e,t)=>{e.stopPropagation(),s.Taro.navigateTo({url:`/pages/booking/confirm/index?type=${t.hasOwnProperty("storeId")?"therapist":"store"}&id=${t.id}`})},N=()=>{s.Taro.navigateTo({url:"/pages/store/list/index"})},R=()=>{s.Taro.showToast({title:"\u529f\u80fd\u5f00\u53d1\u4e2d",icon:"none"})},v=e=>{s.Taro.navigateTo({url:"/pages/promotion/index"})};return s.jsxRuntimeExports.jsxs(s.View,{className:"appointment-page",children:[s.jsxRuntimeExports.jsxs(s.View,{className:"header",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"title",children:"\u75b2\u52b3\u9178\u75db\uff0c\u5230\u5e38\u4e50\u5bf9\u75c7\u63a8\u62ff"}),s.jsxRuntimeExports.jsxs(s.View,{className:"location",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"icon",children:"\ud83d\udccd"}),s.jsxRuntimeExports.jsx(s.Text,{className:"text",children:"\u6b63\u5728\u83b7\u53d6\u4f4d\u7f6e..."})]})]}),s.jsxRuntimeExports.jsxs(s.View,{className:"banner-section",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"section-title",children:"\u4f18\u60e0\u9884\u7ea6"}),s.jsxRuntimeExports.jsx(s.Swiper,{className:"banner-swiper",autoplay:!0,interval:3e3,indicatorDots:!0,indicatorActiveColor:"#D9455F",children:d.map(e=>s.jsxRuntimeExports.jsx(s.SwiperItem,{children:s.jsxRuntimeExports.jsx(s.View,{className:"banner-item",onClick:()=>v(),children:s.jsxRuntimeExports.jsx(s.Image,{className:"banner-image",src:e.image,mode:"aspectFill"})})},e.id))})]}),s.jsxRuntimeExports.jsxs(s.View,{className:"stores-section",children:[s.jsxRuntimeExports.jsxs(s.View,{className:"section-header",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"section-title",children:"\u95e8\u5e97\u9884\u7ea6"}),s.jsxRuntimeExports.jsxs(s.Text,{className:"more-link",onClick:N,children:["\u66f4\u591a\u95e8\u5e97 ",">>"]})]}),s.jsxRuntimeExports.jsx(s.ScrollView,{scrollY:!0,className:"store-list",children:r.map(e=>s.jsxRuntimeExports.jsx(l,{store:e,onClick:()=>j(e),onBooking:s=>E(s,e)},e.id))})]}),s.jsxRuntimeExports.jsxs(s.View,{className:"therapists-section",children:[s.jsxRuntimeExports.jsxs(s.View,{className:"section-header",children:[s.jsxRuntimeExports.jsx(s.Text,{className:"section-title",children:"\u63a8\u62ff\u5e08\u9884\u7ea6"}),s.jsxRuntimeExports.jsxs(s.Text,{className:"more-link",onClick:R,children:["\u66f4\u591a\u75c7\u72b6 ",">>"]})]}),s.jsxRuntimeExports.jsx(s.ScrollView,{scrollY:!0,className:"therapist-list",children:c.map(e=>s.jsxRuntimeExports.jsx(m,{therapist:e,onClick:()=>g(e),onBooking:s=>E(s,e)},e.id))})]})]})};var d={};Page(s.createPageConfig(p,"pages/appointment/index",{root:{cn:[]}},d||{}));

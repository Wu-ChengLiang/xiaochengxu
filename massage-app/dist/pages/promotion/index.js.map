{"version":3,"file":"index.js","sources":["../../../src/pages/promotion/index.tsx"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport Taro from '@tarojs/taro'\nimport { View, Text, Image, ScrollView } from '@tarojs/components'\nimport { AtButton, AtTabs, AtTabsPane } from 'taro-ui'\nimport { bannerGoodnight } from '@/mock/data/images'\nimport './index.scss'\n\ninterface Promotion {\n  id: string\n  title: string\n  subtitle: string\n  originalPrice: number\n  discountPrice: number\n  discount: string\n  image: string\n  validUntil: string\n  remainingQuota: number\n  totalQuota: number\n  description: string[]\n}\n\nconst mockPromotions: Promotion[] = [\n  {\n    id: 'promo-001',\n    title: '晚安好眠套餐',\n    subtitle: '深度放松，一夜好眠',\n    originalPrice: 398,\n    discountPrice: 298,\n    discount: '7.5折',\n    image: bannerGoodnight,\n    validUntil: '2024-12-31',\n    remainingQuota: 86,\n    totalQuota: 200,\n    description: [\n      '60分钟专业推拿服务',\n      '针对性睡眠改善方案',\n      '赠送香薰精油一份',\n      '可选时段：晚7点-10点'\n    ]\n  },\n  {\n    id: 'promo-002',\n    title: '肩颈理疗套餐',\n    subtitle: '告别肩颈疼痛',\n    originalPrice: 298,\n    discountPrice: 198,\n    discount: '6.6折',\n    image: bannerGoodnight,\n    validUntil: '2024-12-31',\n    remainingQuota: 142,\n    totalQuota: 300,\n    description: [\n      '45分钟专业肩颈推拿',\n      '热敷理疗服务',\n      '专业推拿师一对一服务',\n      '适用所有门店'\n    ]\n  },\n  {\n    id: 'promo-003',\n    title: '新客专享套餐',\n    subtitle: '首次体验优惠',\n    originalPrice: 198,\n    discountPrice: 99,\n    discount: '5折',\n    image: bannerGoodnight,\n    validUntil: '2024-12-31',\n    remainingQuota: 58,\n    totalQuota: 100,\n    description: [\n      '30分钟基础推拿服务',\n      '专业体质评估一次',\n      '仅限新用户购买',\n      '每人限购一次'\n    ]\n  }\n]\n\nconst PromotionPage: React.FC = () => {\n  const [currentTab, setCurrentTab] = useState(0)\n  const [promotions, setPromotions] = useState<Promotion[]>([])\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    // 模拟加载数据\n    setTimeout(() => {\n      setPromotions(mockPromotions)\n      setLoading(false)\n    }, 500)\n  }, [])\n\n  const handlePurchase = (promotion: Promotion) => {\n    // 跳转到预约确认页面\n    Taro.navigateTo({\n      url: `/pages/booking/confirm/index?type=promotion&id=${promotion.id}`\n    })\n  }\n\n  const tabList = [\n    { title: '全部优惠' },\n    { title: '限时特惠' },\n    { title: '新客专享' }\n  ]\n\n  const filterPromotions = (tabIndex: number) => {\n    switch (tabIndex) {\n      case 1:\n        return promotions.filter(p => p.discount && parseFloat(p.discount) < 8)\n      case 2:\n        return promotions.filter(p => p.title.includes('新客'))\n      default:\n        return promotions\n    }\n  }\n\n  const renderPromotion = (promotion: Promotion) => (\n    <View className=\"promotion-card\" key={promotion.id}>\n      <Image \n        className=\"promotion-image\" \n        src={promotion.image} \n        mode=\"aspectFill\"\n      />\n      <View className=\"promotion-content\">\n        <View className=\"promotion-header\">\n          <View className=\"title-section\">\n            <Text className=\"promotion-title\">{promotion.title}</Text>\n            <Text className=\"promotion-subtitle\">{promotion.subtitle}</Text>\n          </View>\n          <View className=\"discount-badge\">\n            <Text className=\"discount-text\">{promotion.discount}</Text>\n          </View>\n        </View>\n\n        <View className=\"price-section\">\n          <View className=\"prices\">\n            <Text className=\"discount-price\">¥{promotion.discountPrice}</Text>\n            <Text className=\"original-price\">¥{promotion.originalPrice}</Text>\n          </View>\n          <View className=\"quota-info\">\n            <Text className=\"quota-text\">剩余{promotion.remainingQuota}份</Text>\n            <View className=\"quota-progress\">\n              <View \n                className=\"quota-progress-fill\" \n                style={{ width: `${(promotion.remainingQuota / promotion.totalQuota) * 100}%` }}\n              />\n            </View>\n          </View>\n        </View>\n\n        <View className=\"description-section\">\n          {promotion.description.map((desc, index) => (\n            <Text key={index} className=\"description-item\">• {desc}</Text>\n          ))}\n        </View>\n\n        <View className=\"promotion-footer\">\n          <Text className=\"valid-date\">有效期至 {promotion.validUntil}</Text>\n          <AtButton\n            type=\"primary\"\n            size=\"small\"\n            className=\"purchase-btn\"\n            onClick={() => handlePurchase(promotion)}\n          >\n            立即抢购\n          </AtButton>\n        </View>\n      </View>\n    </View>\n  )\n\n  return (\n    <View className=\"promotion-page\">\n      <View className=\"page-header\">\n        <Text className=\"page-title\">优惠专区</Text>\n        <Text className=\"page-subtitle\">限时特惠，手慢无</Text>\n      </View>\n\n      <AtTabs\n        current={currentTab}\n        tabList={tabList}\n        onClick={setCurrentTab}\n        className=\"promotion-tabs\"\n      >\n        {tabList.map((_, index) => (\n          <AtTabsPane current={currentTab} index={index} key={index}>\n            <ScrollView scrollY className=\"promotion-list\">\n              {loading ? (\n                <View className=\"loading-container\">\n                  <Text className=\"loading-text\">加载中...</Text>\n                </View>\n              ) : (\n                filterPromotions(index).map(promotion => renderPromotion(promotion))\n              )}\n            </ScrollView>\n          </AtTabsPane>\n        ))}\n      </AtTabs>\n    </View>\n  )\n}\n\nexport default PromotionPage"],"names":["mockPromotions","id","title","subtitle","originalPrice","discountPrice","discount","image","bannerGoodnight","validUntil","remainingQuota","totalQuota","description","PromotionPage","currentTab","setCurrentTab","useState","promotions","setPromotions","loading","setLoading","useEffect","setTimeout","handlePurchase","promotion","Taro","navigateTo","url","tabList","filterPromotions","tabIndex","filter","p","parseFloat","includes","renderPromotion","jsxs","View","jsx","Image","Text","width","map","desc","index","AtButton","AtTabs","_","AtTabsPane","ScrollView"],"mappings":"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"}
{"version":3,"file":"index.js","sources":["../../../../src/pages/booking/confirm/index.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\nimport { View, Text, Image, ScrollView } from '@tarojs/components'\nimport Taro, { useRouter } from '@tarojs/taro'\nimport { orderService, CreateOrderParams } from '@/services/order'\nimport { storeService } from '@/services/store'\nimport { therapistService } from '@/services/therapist'\nimport './index.scss'\n\ninterface CartItem {\n  serviceId: string\n  serviceName: string\n  duration: number\n  price: number\n  discountPrice?: number\n  date: string\n  time: string\n  therapistName: string\n  therapistAvatar?: string\n}\n\ninterface OrderConfirmPageParams {\n  therapistId?: string\n  storeId: string\n  items: string // JSON string of CartItem[]\n  from?: string  // Êù•Ê∫êÊ†áËØÜÔºåÂ¶Ç 'symptom'\n}\n\nconst OrderConfirmPage: React.FC = () => {\n  const router = useRouter()\n  const params = router.params as unknown as OrderConfirmPageParams\n  \n  const [cartItems, setCartItems] = useState<CartItem[]>([])\n  const [therapistInfo, setTherapistInfo] = useState<any>(null)\n  const [storeInfo, setStoreInfo] = useState<any>(null)\n  const [loading, setLoading] = useState(true)\n  const [countdown, setCountdown] = useState(180) // 3ÂàÜÈíüÂÄíËÆ°Êó∂\n  const [paymentMethod, setPaymentMethod] = useState('wechat')\n  const timerRef = useRef<any>(null)\n\n  useEffect(() => {\n    // Ëß£Êûê‰º†ÈÄíÁöÑÊï∞ÊçÆ\n    try {\n      const items = JSON.parse(decodeURIComponent(params.items || '[]'))\n      setCartItems(items)\n      \n      // Ëé∑ÂèñÊé®ÊãøÂ∏àÂíåÈó®Â∫ó‰ø°ÊÅØ\n      fetchTherapistAndStoreInfo()\n    } catch (error) {\n      Taro.showToast({\n        title: 'Êï∞ÊçÆËß£ÊûêÂ§±Ë¥•',\n        icon: 'none'\n      })\n      setTimeout(() => Taro.navigateBack(), 1500)\n    }\n  }, [params])\n\n  // ÂÄíËÆ°Êó∂ÈÄªËæë\n  useEffect(() => {\n    if (!loading && cartItems.length > 0) {\n      timerRef.current = setInterval(() => {\n        setCountdown((prev) => {\n          if (prev <= 1) {\n            clearInterval(timerRef.current)\n            Taro.showModal({\n              title: 'ÊîØ‰ªòË∂ÖÊó∂‰∫ÜÂë¶',\n              content: 'Âø´Âø´ÈáçÊñ∞‰∏ãÂçïÂêß~',\n              showCancel: false,\n              success: () => {\n                Taro.navigateBack()\n              }\n            })\n            return 0\n          }\n          return prev - 1\n        })\n      }, 1000)\n    }\n\n    return () => {\n      if (timerRef.current) {\n        clearInterval(timerRef.current)\n      }\n    }\n  }, [loading, cartItems])\n\n  const fetchTherapistAndStoreInfo = async () => {\n    try {\n      setLoading(true)\n\n      // Ëé∑ÂèñÊé®ÊãøÂ∏à‰ø°ÊÅØÔºà‰ªÖÂú®ÊúâtherapistIdÊó∂Ëé∑ÂèñÔºâ\n      if (params.therapistId) {\n        const therapistRes = await therapistService.getTherapistDetail(params.therapistId)\n        setTherapistInfo(therapistRes.data)\n      }\n\n      // Ëé∑ÂèñÈó®Â∫ó‰ø°ÊÅØ\n      const storeRes = await storeService.getStoreDetail(params.storeId)\n      const storeData = storeRes.data\n\n      setStoreInfo(storeData)\n      setLoading(false)\n    } catch (error) {\n      setLoading(false)\n      Taro.showToast({\n        title: 'Ëé∑Âèñ‰ø°ÊÅØÂ§±Ë¥•',\n        icon: 'none'\n      })\n    }\n  }\n\n  const formatCountdown = (seconds: number) => {\n    const mins = Math.floor(seconds / 60)\n    const secs = seconds % 60\n    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`\n  }\n\n  const formatDate = (dateStr: string) => {\n    const date = new Date(dateStr)\n    const month = date.getMonth() + 1\n    const day = date.getDate()\n    return `${month.toString().padStart(2, '0')}Êúà${day.toString().padStart(2, '0')}Êó•`\n  }\n\n  const calculateEndTime = (time: string, duration: number) => {\n    const [hour, minute] = time.split(':').map(Number)\n    const endMinute = minute + duration\n    const endHour = hour + Math.floor(endMinute / 60)\n    const finalMinute = endMinute % 60\n    return `${endHour}:${finalMinute.toString().padStart(2, '0')}`\n  }\n\n  const getTotalPrice = () => {\n    return cartItems.reduce((sum, item) => sum + (item.discountPrice || item.price), 0)\n  }\n\n  const handlePayment = async () => {\n    // ÁóáÁä∂Ë∞ÉÁêÜÊ®°Âºè‰∏ãÊé®ÊãøÂ∏à‰ø°ÊÅØÂú®cartItems‰∏≠Ôºå‰∏çÈúÄË¶ÅtherapistInfo\n    const isSymptomMode = params.from === 'symptom'\n    const needTherapistInfo = !isSymptomMode && !therapistInfo\n\n    if (cartItems.length === 0 || needTherapistInfo || !storeInfo) {\n      Taro.showToast({\n        title: 'ËÆ¢Âçï‰ø°ÊÅØ‰∏çÂÆåÊï¥',\n        icon: 'none'\n      })\n      return\n    }\n\n    try {\n      Taro.showLoading({\n        title: 'ÂàõÂª∫ËÆ¢Âçï...'\n      })\n\n      // ‰ΩøÁî®Á¨¨‰∏Ä‰∏™Ë¥≠Áâ©È°πÁöÑ‰ø°ÊÅØÔºàÂ¶ÇÊûúÊúâÂ§ö‰∏™ÊúçÂä°ÔºåÂèØ‰ª•ÂêéÁª≠‰ºòÂåñÔºâ\n      const firstItem = cartItems[0]\n      const orderParams: CreateOrderParams = {\n        therapistId: params.therapistId || 'symptom-mode', // ÁóáÁä∂Ë∞ÉÁêÜÊ®°Âºè‰ΩøÁî®ÁâπÊÆäÊ†áËØÜ\n        storeId: params.storeId,\n        serviceId: firstItem.serviceId,\n        serviceName: firstItem.serviceName,\n        duration: firstItem.duration,\n        price: firstItem.price,\n        discountPrice: firstItem.discountPrice,\n        appointmentDate: firstItem.date,\n        appointmentTime: firstItem.time,\n        therapistName: firstItem.therapistName,\n        therapistAvatar: firstItem.therapistAvatar || (therapistInfo?.avatar)\n      }\n\n      // ÂàõÂª∫ËÆ¢Âçï\n      const order = await orderService.createOrder(orderParams)\n      \n      Taro.hideLoading()\n      Taro.showLoading({\n        title: 'Ê≠£Âú®ÊîØ‰ªò...'\n      })\n\n      // Ëé∑ÂèñÊîØ‰ªòÂèÇÊï∞\n      const paymentParams = await orderService.getPaymentParams(order.orderNo)\n      \n      Taro.hideLoading()\n      \n      // Ë∞ÉÁî®ÂæÆ‰ø°ÊîØ‰ªòÔºàMockÁéØÂ¢ÉÁõ¥Êé•Ê®°ÊãüÊàêÂäüÔºâ\n      if (process.env.NODE_ENV === 'development') {\n        // ÂºÄÂèëÁéØÂ¢ÉMockÊîØ‰ªòÊàêÂäü\n        await orderService.updateOrderStatus(order.orderNo, 'paid')\n        \n        Taro.showToast({\n          title: 'ÊîØ‰ªòÊàêÂäü',\n          icon: 'success',\n          duration: 1500\n        })\n        \n        setTimeout(() => {\n          Taro.redirectTo({\n            url: `/pages/booking/success/index?orderNo=${order.orderNo}`\n          })\n        }, 1500)\n      } else {\n        // Áîü‰∫ßÁéØÂ¢ÉË∞ÉÁî®ÁúüÂÆûÊîØ‰ªò\n        Taro.requestPayment({\n          ...paymentParams,\n          success: async () => {\n            // Êõ¥Êñ∞ËÆ¢ÂçïÁä∂ÊÄÅ‰∏∫Â∑≤ÊîØ‰ªò\n            await orderService.updateOrderStatus(order.orderNo, 'paid')\n            \n            Taro.showToast({\n              title: 'ÊîØ‰ªòÊàêÂäü',\n              icon: 'success',\n              duration: 1500\n            })\n            \n            setTimeout(() => {\n              Taro.redirectTo({\n                url: `/pages/booking/success/index?orderNo=${order.orderNo}`\n              })\n            }, 1500)\n          },\n          fail: (err) => {\n            console.error('ÊîØ‰ªòÂ§±Ë¥•:', err)\n            if (err.errMsg !== 'requestPayment:fail cancel') {\n              // Â¶ÇÊûúÊòØÁº∫Â∞ëtotal_feeÁöÑÈîôËØØÔºåÁªôÂá∫Êõ¥ÊòéÁ°ÆÁöÑÊèêÁ§∫\n              if (err.errMsg && err.errMsg.includes('total_fee')) {\n                Taro.showToast({\n                  title: 'ÊîØ‰ªòÂèÇÊï∞ÈîôËØØÔºöÁº∫Â∞ëÈáëÈ¢ù‰ø°ÊÅØ',\n                  icon: 'none',\n                  duration: 2500\n                })\n              } else {\n                Taro.showToast({\n                  title: 'ÊîØ‰ªòÂ§±Ë¥•',\n                  icon: 'none'\n                })\n              }\n            }\n          }\n        })\n      }\n    } catch (error) {\n      Taro.hideLoading()\n      Taro.showToast({\n        title: error.message || 'ËÆ¢ÂçïÂàõÂª∫Â§±Ë¥•',\n        icon: 'none'\n      })\n    }\n  }\n\n  if (loading) {\n    return (\n      <View className=\"order-confirm-page\">\n        <View className=\"loading\">Âä†ËΩΩ‰∏≠...</View>\n      </View>\n    )\n  }\n\n  return (\n    <ScrollView className=\"order-confirm-page\" scrollY>\n      {/* Èó®Â∫ó‰ø°ÊÅØ */}\n      <View className=\"store-section\">\n        <Text className=\"store-name\">{storeInfo?.name}</Text>\n        <Text className=\"store-distance\">üìç {storeInfo?.distance}km</Text>\n      </View>\n\n      {/* È¢ÑÁ∫¶‰ø°ÊÅØ */}\n      <View className=\"booking-info\">\n        {cartItems.map((item, index) => (\n          <View key={index} className=\"booking-item\">\n            <Image \n              className=\"therapist-avatar\" \n              src={item.therapistAvatar || therapistInfo?.avatar} \n            />\n            <View className=\"booking-details\">\n              <View className=\"therapist-name\">{item.therapistName}</View>\n              <View className=\"service-time\">\n                {formatDate(item.date)} {item.time} Ëá≥ {calculateEndTime(item.time, item.duration)}\n              </View>\n              <View className=\"service-name\">{item.serviceName}</View>\n            </View>\n            <View className=\"service-price\">¬•{item.discountPrice || item.price}</View>\n          </View>\n        ))}\n      </View>\n\n      {/* ÈÄÄÂçïËØ¥Êòé */}\n      <View className=\"refund-policy\">\n        <Text className=\"policy-title\">ÈÄÄÂçïËØ¥Êòé</Text>\n        <View className=\"policy-list\">\n          <View className=\"policy-item\">\n            ‚Ä¢ ‰∏ãÂçï15ÂàÜÈíüÂÜÖÊàñË∑ùËÆ¢ÂçïÂºÄÂßãÊó∂Èó¥&gt;6Â∞èÊó∂ÈÄÄÂçïÔºåÈÄÄ100%\n          </View>\n          <View className=\"policy-item\">\n            ‚Ä¢ Ë∑ùËÆ¢ÂçïÂºÄÂßãÂâç&lt;6Â∞èÊó∂ÈÄÄÂçïÔºåÈÄÄÂÆû‰ªòÈáëÈ¢ù90%\n          </View>\n          <View className=\"policy-item\">\n            ‚Ä¢ ËÆ¢ÂçïÊó∂Èó¥ÂºÄÂßãÂêéÈÄÄÂçïÔºåÈÄÄÂÆû‰ªòÈáëÈ¢ù80%\n          </View>\n        </View>\n      </View>\n\n      {/* ÂÆ¢Êà∑Â§áÊ≥® */}\n      <View className=\"customer-note\">\n        <Text className=\"note-title\">ÂÆ¢Êà∑Â§áÊ≥®</Text>\n        <Text className=\"note-hint\">ÊÇ®ÂØπËå∂Ê∞¥„ÄÅÊàøÈó¥„ÄÅÊåâÊë©ÊúçÁ≠âÊòØÂê¶ÊúâÁâπÊÆäÈúÄÊ±ÇÔºåÊàë‰ª¨Â∞ÜÊèêÂâç‰∏∫ÊÇ®ÂÅöÂ•ΩÂáÜÂ§á</Text>\n      </View>\n\n      {/* ÊîØ‰ªòÊñπÂºè */}\n      <View className=\"payment-section\">\n        <Text className=\"section-title\">ÊîØ‰ªòÊñπÂºè</Text>\n        <View className=\"payment-methods\">\n          <View \n            className={`payment-method ${paymentMethod === 'wechat' ? 'active' : ''}`}\n            onClick={() => setPaymentMethod('wechat')}\n          >\n            <View className=\"method-info\">\n              <Text className=\"method-icon\">‚úÖ</Text>\n              <Text className=\"method-name\">ÂæÆ‰ø°ÊîØ‰ªò</Text>\n            </View>\n            <View className={`check-icon ${paymentMethod === 'wechat' ? 'checked' : ''}`} />\n          </View>\n        </View>\n      </View>\n\n      {/* Â∫ïÈÉ®ÊîØ‰ªòÊ†è */}\n      <View className=\"payment-bar\">\n        <View className=\"price-info\">\n          <Text className=\"total-price\">¬• {getTotalPrice()}</Text>\n          <Text className=\"countdown\">ÊîØ‰ªòÂÄíËÆ°Êó∂: {formatCountdown(countdown)}</Text>\n        </View>\n        <View className=\"pay-button\" onClick={handlePayment}>\n          ÂéªÊîØ‰ªò\n        </View>\n      </View>\n    </ScrollView>\n  )\n}\n\nexport default OrderConfirmPage"],"names":["OrderConfirmPage","router","useRouter","params","cartItems","setCartItems","useState","therapistInfo","setTherapistInfo","storeInfo","setStoreInfo","loading","setLoading","countdown","setCountdown","paymentMethod","setPaymentMethod","timerRef","useRef","useEffect","items","JSON","parse","decodeURIComponent","error","Taro","showToast","title","icon","setTimeout","navigateBack","length","current","setInterval","prev","clearInterval","showModal","content","showCancel","success","fetchTherapistAndStoreInfo","therapistId","therapistRes","therapistService","getTherapistDetail","data","storeRes","storeService","getStoreDetail","storeId","storeData","formatCountdown","seconds","mins","Math","floor","secs","toString","padStart","formatDate","dateStr","date","Date","month","getMonth","day","getDate","calculateEndTime","time","duration","hour","minute","split","map","Number","endMinute","endHour","finalMinute","getTotalPrice","reduce","sum","item","discountPrice","price","handlePayment","isSymptomMode","from","needTherapistInfo","showLoading","firstItem","orderParams","serviceId","serviceName","appointmentDate","appointmentTime","therapistName","therapistAvatar","avatar","order","orderService","createOrder","hideLoading","paymentParams","getPaymentParams","orderNo","process","updateOrderStatus","redirectTo","url","message","jsx","View","jsxs","ScrollView","Text","name","distance","index","Image"],"mappings":"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"}
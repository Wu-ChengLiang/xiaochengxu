# 推拿预约小程序API文档

## 文档说明

本文档定义了推拿预约小程序的API接口规范，采用简单实用的设计原则，便于快速实施。

## 文档列表

1. **[00-通用规范.md](./00-通用规范.md)** - API通用设计规范
2. **[01-门店API.md](./01-门店API.md)** - 门店相关接口
3. **[02-推拿师API.md](./02-推拿师API.md)** - 推拿师相关接口
4. **[03-预约API.md](./03-预约API.md)** - 预约相关接口
5. **[04-用户API.md](./04-用户API.md)** - 用户相关接口
6. **[05-实施指南.md](./05-实施指南.md)** - 实施步骤和建议

## 快速开始

### 1. 核心接口清单

| 功能 | 方法 | 路径 | 说明 |
|------|------|------|------|
| 附近门店 | GET | /api/v2/stores/nearby | 获取门店列表 |
| 门店详情 | GET | /api/v2/stores/:id | 获取门店信息 |
| 推荐推拿师 | GET | /api/v2/therapists/recommended | 获取推拿师列表 |
| 推拿师详情 | GET | /api/v2/therapists/:id | 获取推拿师信息 |
| 创建预约 | POST | /api/v2/appointments | 创建新预约 |
| 预约详情 | GET | /api/v2/appointments/:id | 获取预约信息 |
| 我的预约 | GET | /api/v2/appointments/mine | 获取用户预约列表 |
| 可用时段 | GET | /api/v2/appointments/available-slots | 查询可预约时间 |

### 2. 数据格式示例

#### 请求示例
```bash
curl "http://localhost:3001/api/v2/stores/nearby?latitude=22.5431&longitude=114.0579"
```

#### 响应示例
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "list": [
      {
        "id": "1",
        "name": "明医推拿（罗湖店）",
        "address": "深圳市罗湖区东门南路1234号",
        "distance": 1.2,
        "status": "normal"
      }
    ],
    "total": 38,
    "page": 1,
    "pageSize": 10
  }
}
```

## 设计特点

### 1. 简单实用
- 最小化数据库改动
- 优先使用现有字段
- 通过API层处理差异

### 2. 渐进实施
- 分阶段实现功能
- 保持向后兼容
- 支持灰度发布

### 3. 双端兼容
- v1接口：现有网页前端
- v2接口：小程序使用
- 共享同一数据库

## 关键决策

### 1. ID处理
- 数据库：INTEGER类型
- API返回：统一转为string
- 原因：避免JavaScript大数精度问题

### 2. 图片资源
- 初期：使用静态文件规则
- 格式：`/images/{type}/{id}.jpg`
- 后续：可升级云存储

### 3. 位置信息
- 初期：返回默认排序
- 后续：添加经纬度字段
- 距离：前端计算或后端计算

### 4. 用户系统
- 初期：手机号识别
- 无需：注册登录
- 后续：可接入微信登录

## 实施优先级

### P0 - 必须实现（第一周）
- [x] 门店列表
- [x] 推拿师列表
- [x] 创建预约
- [x] 查看预约

### P1 - 重要功能（第二周）
- [ ] 时段查询
- [ ] 取消预约
- [ ] 用户信息
- [ ] 搜索功能

### P2 - 增强功能（后续）
- [ ] 评价系统
- [ ] 会员系统
- [ ] 优惠券
- [ ] 推送通知

## 联系方式

如有问题，请联系开发团队。

---
更新时间：2024-01-20